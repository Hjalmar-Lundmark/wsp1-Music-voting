{% extends "layout.njk" %}
{% block content %}

<h1>Utspringslåt - NTI TE20</h1>
<h3>Rösta för den låt du vill ska väljas till utspringet. Måsta vara inloggad för att rösta eller skicka in en låt.
    1 röst per person. Sista dag är 29 maj. {% if loggedIn %}<a href="/new">Föreslå låt.</a>{% endif %} 
    {% if voted and votingEnabled %}
    <form action="/removeVote" method="post" class="form-wo-border">
        <button class="changeBtn">Byt röst</button>
    </form>
    {% endif %}</h3>
    {% if (votingEnabled==false) %}
        <h2 style="margin: 2rem;">Voting has now concluded and the most voted song has been confirmed. Thank you!</h2>
    {% endif %}
<ul>
    {% for row in rows %}
    <li>
        <iframe style="border-radius:12px"
            src="https://open.spotify.com/embed/{{ row.sType }}/{{ row.songId }}?utm_source=generator" width="100%" height="352"
            frameBorder="0" allowfullscreen=""
            allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
        <div class="postContent">
            {% if loggedIn and (voted == false) and votingEnabled %}
                    <form action="/vote" method="post" class="form-wo-border">
                        <button class="voteBtn">Rösta</button>
                        <select name="rowId" id="rowId">
                            <option value="{{ row.id }}"></option>
                        </select>
                    </form>
            {% endif %}
            {% if voted and (votedOn == row.songId) %}
                <p>✅</p>
            {% endif %}
            <p>Röster: {{ row.votes }}</p>
        </div>
    </li>
    {% endfor %}
</ul>
{% endblock %}